---
# Global Variables f√ºr alle Hosts

# === GENERAL ===
timezone: "UTC"
locale: "en_US.UTF-8"

# === SSH HARDENING ===
ssh_port: 22
ssh_password_authentication: false
ssh_permit_root_login: "prohibit-password"
ssh_max_auth_tries: 3

# === FIREWALL ===
ufw_enabled: true
ufw_default_incoming: deny
ufw_default_outgoing: allow

# === AUTOMATIC UPDATES ===
unattended_upgrades: true
auto_reboot: false
auto_reboot_time: "03:00"

# === FAIL2BAN ===
fail2ban_enabled: true
fail2ban_bantime: 3600
fail2ban_maxretry: 3

# === HAVOC TEAMSERVER ===
havoc_repo: "https://github.com/HavocFramework/Havoc.git"
havoc_install_path: "/opt/Havoc"
havoc_profile_path: "/opt/Havoc/profiles/havoc.yaotl"

teamserver:
  host: "0.0.0.0"
  port: 40056
  operators:
    - name: "admin"
      password: "{{ admin_password | default('ChangeMe123!') }}"
    - name: "operator1"
      password: "{{ operator1_password | default('Operator123!') }}"
  
  listeners:
    - name: "HTTPS Listener"
      protocol: "https"
      port: 443
      hosts:
        - "0.0.0.0"

# === REDIRECTOR ===
redirector:
  uri_paths:
    - "/api"
    - "/updates"
    - "/content"
  
  blocked_user_agents:
    - "bot"
    - "spider"
    - "crawler"
    - "scanner"
    - "curl"
    - "wget"
    - "python"
    - "nmap"
    - "masscan"
  
  blocked_ips:
    - "192.0.2.0/24"
    - "198.18.0.0/15"
    - "203.0.113.0/24"

# === SSL/TLS ===
letsencrypt:
  email: "{{ admin_email | default('admin@example.com') }}"
  agree_tos: true
  staging: false  # Set to true for testing

# === MONITORING ===
monitoring_enabled: true
log_rotation_days: 14
